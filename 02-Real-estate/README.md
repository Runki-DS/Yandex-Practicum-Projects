# Проект: Исследование объявлений о продаже квартир
<h2>Описание проекта:</h2>
В вашем распоряжении данные сервиса Яндекс Недвижимость — архив объявлений о продаже квартир в Санкт-Петербурге и соседних населённых пунктах за несколько лет. Вам нужно научиться определять рыночную стоимость объектов недвижимости. Для этого проведите исследовательский анализ данных и установите параметры, влияющие на цену объектов. Это позволит построить автоматизированную систему: она отследит аномалии и мошенническую деятельность. 
По каждой квартире на продажу доступны два вида данных. Первые вписаны пользователем, вторые — получены автоматически на основе картографических данных. Например, расстояние до центра, аэропорта и других объектов — эти данные автоматически получены из геосервисов. Количество парков и водоёмов также заполняется без участия пользователя.

<h2>Список параметров:</h2>
<ul>
<li>общая площадь;</li>
<li>жилая площадь;</li>
<li>площадь кухни;</li>
<li>цена объекта;</li>
<li>количество комнат;</li>
<li>высота потолков;</li>
<li>тип этажа квартиры («первый», «последний», «другой»);</li>
<li>общее количество этажей в доме;</li>
<li>расстояние до центра города в метрах;</li>
<li>расстояние до ближайшего парка</li>
</ul>

<h2>Описание данных</h2>
<ul>
<li><b>airports_nearest</b> — расстояние до ближайшего аэропорта в метрах (м)
<li><b>balcony</b> — число балконов
<li><b>ceiling_height</b> — высота потолков (м)
<li><b>cityCenters_nearest</b> — расстояние до центра города (м)
<li><b>days_exposition</b> — сколько дней было размещено объявление (от публикации до снятия)
<li><b>first_day_exposition</b> — дата публикации
<li><b>floor</b> — этаж
<li><b>floors_total</b> — всего этажей в доме
<li><b>is_apartment</b> — апартаменты (булев тип)
<li><b>kitchen_area</b> — площадь кухни в квадратных метрах (м²)
<li><b>last_price</b> — цена на момент снятия с публикации
<li><b>living_area</b> — жилая площадь в квадратных метрах (м²)
<li><b>locality_name</b> — название населённого пункта
<li><b>open_plan</b> — свободная планировка (булев тип)
<li><b>parks_around3000</b> — число парков в радиусе 3 км
<li><b>parks_nearest</b> — расстояние до ближайшего парка (м)
<li><b>ponds_around3000</b> — число водоёмов в радиусе 3 км
<li><b>ponds_nearest</b> — расстояние до ближайшего водоёма (м)
<li><b>rooms</b> — число комнат
<li><b>studio</b> — квартира-студия (булев тип)
<li><b>total_area</b> — общая площадь квартиры в квадратных метрах (м²)
<li><b>total_images</b> — число фотографий квартиры в объявлении
</ul>

## Общий вывод

Для исследовательской работы нам были предоставлены данные сервиса Яндекс Недвижимость — архив объявлений о продаже квартир в Санкт-Петербурге и соседних населённых пунктах за несколько лет. Все данные, кроме данных геосервисов формировались пользователями вручную.

В качестве исследовательской задачи была поставлена: научиться определять рыночную стоимость объектов недвижимости и установить параметры, влияющие на цену объектов.

**Конечная цель**: построить автоматизированную систему для отслеживания аномалии и мошеннической деятельности. Однако, нам не были предоставлены описания типичных мошеннических схем и свойственных им аномалий, чтобы научиться их определять. Из личной практики, на указанных данных мы можем определять лишь мошеннические аномалии связанные с некорректно низкой ценой, а для этого нужно задавать шаблон на основе диаграммы размаха по распределению цены квадратного метра в каждом населенном пункте и, например, все что ниже первого квартиля считать условной аномалией и разбираться по дополнительным признакам имеют ли место мошеннические действия. К сожалению, в данной работе такая задача нам не ставилась - рекомендую добавить.

**Пример задачи**: составить диаграммы размаха (хотя бы по топ 10), и вывести в отдельную таблицу все значения ниже первого квартиля.

Однако, для качественного определения признаков мошеннических действий, не хватает информации о:
 - Типе продаваемой квартиры: новостройка или вторичная продажа
 - Включении задатка при продаже квартиры
 - Собственниках квартиры (единственный, долевая, есть ли несовершеннолетние собственнки). Однако для этого необходимо решить вопрос с интеграцией с данными Росреестра.
 - Наличии долгов по ЖКХ. Муторно, но в теории возможно интегрироваться с управляющими компаниями, хотя у них и нет единой системы учета коммунальных платежей, либо как-то получать данные о коммунальных долгах через Госуслуги.
 - Проверка статуса собственников (жив/мертв), на основании данных из Росреестра можно получать из данных Федеральной нотариальной палаты, или косвенно из ФНС.

### Предобработка данных
В ходе предобработки данных были выявлены следующие аномалии, которые можно отнести к человеческому фактору:
 - наличие пропусков и некорректное указание высоты потолков
 - наличие пропусков в данных о жилой площади
 - наличие пропусков в количестве этажей в доме
 - наличие пропусков в данных о том, аппартаменты это или нет
 - наличие пропусков в данных о площади кухни
 - наличие пропусков в данных о количестве балконов
 - наличие пропусков в названии населенного пункта
 - отсутствие единообразия в заполнении даных о населенном пункте
Однако, мы имеем, в том числе, большое количество и явно технических пропусков, из-за чего не все пропуски из-за человеческого фактора могут быть таковыми.

В ходе предобработки данных были выявлены следующие аномалии:
 - не соответствующие общей стилистике завания колонок
 - наличие пропусков в данных о расстоянии до ближайшего аэропорта
 - наличие пропусков в данных о расстоянии до центра города
 - наличие пропусков в данных о числе парков в радиусе 3 км
 - наличие пропусков в данных о расстоянии до ближайшего парка
 - наличие пропусков в данных о числе водоёмов в радиусе 3 км
 - наличие пропусков в данных о расстояние до ближайшего пруда
 - наличие пропусков в данных о числе дней размещения объявления

Для исправления выявленных аномалий были приняты следующие меры:
 - названия столбцов приведены к единому "змеиному" стилю
 - пропуски в данных о числе дней размещения объявления заменены на 0-вые
 - строки с пропусками данных о числе этажей в доме удалены, так как их количество незначительное и не влияет на анализ
 - пропуски в данных о количестве балконов зполнены 0-ми
 - строки с пропусками данных о названии населенного пункта удалены, так как их количество незначительное и не влияет на анализ. Сами названия приведены к единой форме с удалением неявных дубликатов
 - пропуски в данных о том, аппартаменты это или нет, заменены на False
 - пропуски в данных о количестве парков в радиусе 3 км заменены 0-ми
 - пропуски в данных о количестве прудов в радиусе 3 км заменены 0-ми
 - пропуски в данных о жилой площади заполнены медианными данными
 - пропуски в данных о площади кухни заменены 0-ми
 - пропуски в данных о расстоянии до ближайшего парка заменены на 0-вые
 - пропуски в данных о расстоянии до ближайшего пруда заменены на 0-вые
 - пропуски в данных о расстоянии до ближайшего аэропорта заменены на 0-вые
 - пропуски в данных о расстоянии до центра Санкт-Петербурга заполнены на основании медианных значений и на основании вручную собранных геоданных
 - аномалии в данных о высоте потолков испралены, пропуски заполнены медианными значениями и средним по строительныи нормам - 2.6
Также форматы данных приведены к более подходящим и удобным для работы форматам.

Для дальнейшего анализа данных в датафрейм добавлены столбцы с дополнительными данными:
 - данные о цене квадратного метра
 - данные о дне недели публикации объявления
 - данные о месяце публикации объявления
 - данные о годе публикации объявления
 - данные о типе этажа (первый, последний, другой)
 - данные о расстоянии до центра города в километрах

## Задачи проекта и результаты
В качестве основной задачи необходимо определить рыночную стоимость объектов недвижимости и установить параметры, влияющие на цену объектов.

В ходе исследования установлено:
 - чаще всего продаются квартиры с типовыми размерами общей площади 30, 45 и 60 кв. метров и судя по квадратуре чаще всего продаются квартиры с типовым метражом для однокомнатных и двухкомнатных квартир
 - чаще всего продаются квартиры с жилой площадью 17, 31 и 45 кв. метров. Это соответствует нормам жилой площади для студий, однокомнатных и двухкомнатных квартир
- чаще всего продаются квартиры с площадбю кухни 0 (студии или евро), 6, 7, 8, 9, 10, 11, что соответствует типовым стандартам завтройки разных годов, для квартир с разным количеством комнат.
 - чаще всего продаются квартиры в среднем в диапазоне от 3 до 4,5 млн. рублей
 - чаще всего продаются однокомнатные и двухкомнатные квартиры, что подтверждает ранее сделанные выводны на основании общей, жилой площади квартир и площади кухни в квартирах
 - чаще всего продаются квартиры с высотой потолков 2.5, 2.6, 2.7 м. Это стандарты высоты потолков для пятиэтажных "хрущевок" и девятиэтажных "панелек", то есть квартир типовой застройки.
 - квартиры на последних этажах продаются чаще, чем на первых
 - чаще всего продаются квартиры в 5-этажных "хрущевках" и 9-этажных "панельках"
 - основная масса объявлений приходится на Санкт-Петербург, Гатчину и Всеволожск. В самом Санкт-Петербурге, квартиры чаще всего продаются за пределами центра города, ближе к окраине, в спальных районах.
 - относительно расстояний до ближайшего парка, чаще всего квартиры продаются в зоне 390-450 метров до ближайшего парка в околопарково зоне квартиры продаются существенно реже.
 - в основном квартиры продаются в срок от 22 дней до 6 месяцев. Средний срок продажи квартир - 5 месяцев. Но подавляющее большинство объявлений закрывается в срок до 50 дней. При этом чаще всего объявления закрываются на 45 и 60 день. Также установлено что есть пики снятия публикаций на 5 и 30 день. В итоге все продажи до 22 дней можнго отнести к быстрым, продажи свыше 73 дней долгими, а свыше 198 дней чрезвычайно долгими.

Кроме того установлено, что:
 - общая площадь сильнее всего влияетна цену объекта
 - жилая площадь меньше влияет на цену объекта и зависимость скорее является косвенной и производной от общей площади
 - площадь кухни слабо виляет на цену объекта и это показатель опять же скорее косвенный и производный от общей площади
 - количество комнат напрямую слабо влияет на цену объекта, опять же гораздо важнее общая площадь, которую эти комнаты образуют и географическое расположение квартиры
 - квартиры на первом этаже самые дешевые, на последнем этаже немного дороже и квартиры на любом другом этажи дороже чем на первом или последнем.
 - самая высокая цена у объявлений размещенных во вторник, самая низкая у объявлений размещенных в воскресенье
 - с точки зрения сезонности дороже всего квартиры продаются в апреле, дешевле всего в июне в начале сезона отпусков. но к зиме, цены начинают повышаться
 - в исследуемых годах, самая высокая цена на недвижимость была в 2014 году, затем резко снижалась и начала расто только св 2018-2019 годах.
 - из 10 самых популярных по количеству объявлений населенных пунктов дороже всего кварриры в Санкт-Петербурге, дешевле всего в Выборге
В самом Санкт-Петербурге, по мере удаления от центра, стоимость квартир планомерно снижается (за исключением привокзальных районов и около кладбищ). Также, по сравнению с такой же удаленностью, довольно дорогими можно считать квартиры в Царском Селе (Пушкин).

## Рекомендации
По результатам проведенной работы можно дать следующие рекомендации:
 - Из-за большо количества технических ошибок необходимо сделать повторную выгрузку данных и провести повторную исследовательскую работу на более качественных реальных данных.
 - Получить пояснения от команды проекта о том, в каких случаях пропуски данных являются естественными и по какой причине.
 - Протестировать внедрение интеграции с данными сайта https://dom.mingkh.ru/. При заполнении адреса объекта недвижимости это позволит выставить значения по умолчанию о количестве этажей, внедрить категорию "тип застройки" для определения тиовых и индивидуальных проектов.  - При застройке типового объекта можно сразу выставлять параметры по умолчанию, если пользователь их не вводит, взяв параметры типовых зсатроек, например с сайта https://www.kvmeter.ru/.
 - При указани данных о населенном пункте и адресе объекта недвижимости, внедрить справочник населенных пунктов, и сделать заполение по подсказке в соответствии с КЛАДР или ФИАС, чтобы данные данные были единообразные и стандартизированные.
 - В таких параметрах как "Студия", "Апартаменты" и "Свободная планировка" по умолчанию выставлять параметр "False", в случае, если отсутствует "галочка" в нужном блоке.
 - При указании параметра "Количество балконов" по умолчанию выставлять параметр "0", если данные не указываются.
 - При определении количества парков и прудов в радиусе 3 км, предусмотреть значение "0", при их отсуствии, чтобы избежать пропуска данных.
 - В данных о количестве дней размешения:
   - проверить сработку автоматики на пиковых днях: 30, 45, 60 и т.п. В случае, если закрытие объявлений действительно происходит автоматически, ввести дополнительную информацию в данные: ручное или автоматическое закрытие объявлений.
   - для контроля повторных поубликаций, с целью повышения рейтинга, ввести id объявлений и объектов недвижимости, это позволит считать реальное количество дней размещения объявления до продажи, а также отслеживать повторное выставление на продажу объекта недвижимости.
 - Для более точно определения признаков мошеннических действий, дополнительно предусмотреть в анкете объекта недвижимости указанные выше параметры:
   - типе продажи: новостройка или вторичная продажа
   - включен ли задаток при продаже квартиры
   - собственность единоличная или долевая
 - Отдельно протестировать возможность интеграции данных с Росреестром, Госуслугами, Федеральной нотариальной палатой, ФНС.

**Дополнительно**: Включить в текущую учебную программу задачу на выявление объявлений ниже первого квартиля с группировкой по населенным пунктам. Пример решения задачи ниже.

```
# создадим словарь со значением 1 квартиля по каждому населенному пункту
data_quantile = data.groupby('locality_name')['last_price'].quantile(0.25).to_dict()
# создадим отдельную колонку со значением первого квантиля цены по каждому населенному пункту
data.insert(4, 'price_quantile', data['locality_name'].map(data_quantile))
# выведем на экран все значения ниже первого квантиля для своих населенных пунктов
data.query('last_price < price_quantile')
```

В итоге мы получили 5709 записей со значениями ниже первого квантиля, с которыми можно разбираться. Хотя на деле это очень грубый расчет, так как значения квантилей надо обновлять ежегодно для каждого населенного пункта - так как ежегодно происходит изменение средней цены недвижимости. Но даже в таком грубом расчете уже можно выделить блок объявлений для поиска других дополнительных признаков мошенничества.
